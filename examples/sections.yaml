# yaml-language-server: $schema=../regis_cli/schemas/scorecard.schema.json
name: Example Scorecard

links:
  - label: Merge Request
    url: "https://my-dashboard.corp/images/{request[repository]}?tag={request[tag]}"
  - label: JSON
    url: report.json
pages:
  - name: Evaluation
    sections:
      - name: Policies
        levels:
          - name: mandatory
            order: 1
          - name: optional
            order: 2
        rules:
          - name: no-critical-vulns
            title: No critical vulnerabilities
            condition:
              "==": [{ var: results.trivy.critical_count }, 0]
            level: mandatory
            tags: [security]
          - name: no-high-vulns
            title: No high vulnerabilities
            condition:
              "==": [{ var: results.trivy.high_count }, 0]
            level: optional
            tags: [security]
          - name: age
            title: Image is less than 1 year old
            condition:
              "<=": [{ var: results.freshness.age_days }, 365]
            level: optional
            tags: [maturity]
          - name: size-max
            title: Image is less than 1 Go
            condition:
              "<=": [{ var: results.size.total_compressed_bytes }, 1073741824]
            level: optional
            tags: [technical]

  - name: Reports
    sections:
      - name: Technical
        display:
          analyzers: [size, versioning, hadolint, skopeo]
      - name: Maturity
        display:
          analyzers: [endoflife, freshness, popularity]
      - name: Security
        display:
          analyzers: [trivy, sbom, scorecarddev, provenance]
