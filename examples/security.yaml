name: Security
description: Evaluate container image security posture

display:
  analyzers:
    - trivy
  widgets:
    - label: Critical Vulnerabilities
      value: results.trivy.critical_count
      icon: ðŸ”´
    - label: High Vulnerabilities
      value: results.trivy.high_count
      icon: ðŸŸ 

levels:
  - name: mandatory
    label: Mandatory
    order: 1
  - name: recommended
    label: Recommended
    order: 2
  - name: optional
    label: Optional
    order: 3

rules:
  - name: no-critical-vulns
    title: No critical vulnerabilities
    level: mandatory
    condition:
      "==": [{ var: results.trivy.critical_count }, 0]

  - name: no-high-vulns
    title: No high vulnerabilities
    level: recommended
    condition:
      "==": [{ var: results.trivy.high_count }, 0]

  - name: has-provenance
    title: Build provenance present
    level: optional
    condition:
      "==": [{ var: results.provenance.has_provenance }, true]
