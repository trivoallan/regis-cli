{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://regis-cli/schemas/deps.schema.json",
  "title": "Deps Analyzer Report",
  "description": "Base image dependencies and their end-of-life status.",
  "type": "object",
  "required": ["analyzer", "repository", "tag", "base_image_count", "has_eol_dependency", "dependencies"],
  "properties": {
    "analyzer": { "type": "string", "const": "deps" },
    "repository": { "type": "string" },
    "tag": { "type": "string" },
    "base_image_count": { "type": "integer", "minimum": 0 },
    "has_eol_dependency": { "type": "boolean" },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["image", "tag", "digest", "eol_check"],
        "properties": {
          "image": { "type": "string" },
          "tag": { "type": ["string", "null"] },
          "digest": { "type": ["string", "null"] },
          "eol_check": {
            "type": "object",
            "required": ["product", "product_found", "is_eol", "cycle"],
            "properties": {
              "product": { "type": "string" },
              "product_found": { "type": "boolean" },
              "is_eol": { "type": ["boolean", "null"] },
              "cycle": { "type": ["string", "null"] }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
