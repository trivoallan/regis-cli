{
  "$id": "https://regis-cli/schemas/hadolint.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Hadolint Analyzer Report",
  "type": "object",
  "required": [
    "analyzer",
    "repository",
    "tag",
    "passed",
    "issues_count",
    "issues_by_level",
    "issues"
  ],
  "properties": {
    "analyzer": {
      "type": "string",
      "const": "hadolint"
    },
    "repository": {
      "type": "string"
    },
    "tag": {
      "type": "string"
    },
    "error": {
      "type": "string",
      "description": "Any error encountered during execution."
    },
    "passed": {
      "type": "boolean",
      "description": "True if no issues were found, False otherwise."
    },
    "issues_count": {
      "type": "integer",
      "description": "Total number of issues found."
    },
    "issues_by_level": {
      "type": "object",
      "description": "Count of issues grouped by severity level.",
      "properties": {
        "error": { "type": "integer", "default": 0 },
        "warning": { "type": "integer", "default": 0 },
        "info": { "type": "integer", "default": 0 },
        "style": { "type": "integer", "default": 0 }
      },
      "additionalProperties": false
    },
    "issues": {
      "type": "array",
      "description": "List of issues found by Hadolint.",
      "items": {
        "type": "object",
        "required": ["code", "level", "message"],
        "properties": {
          "code": {
            "type": "string",
            "description": "Hadolint rule code (e.g., DL3008)."
          },
          "level": {
            "type": "string",
            "enum": ["error", "warning", "info", "style"],
            "description": "Severity level of the issue."
          },
          "message": {
            "type": "string",
            "description": "Description of the issue."
          },
          "line": {
            "type": ["integer", "null"],
            "description": "Line number in the pseudo-Dockerfile."
          }
        }
      }
    }
  }
}
