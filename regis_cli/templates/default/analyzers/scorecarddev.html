{% import theme ~ "/macros.html" as m with context %}

<article>
    <header>
        <h3 style="margin: 0;">OpenSSF Scorecard{% if data.score is not none %} — {{ data.score }}/10{% endif %}</h3>
    </header>
    {% if data.source_repo %}
        <p><strong>Source:</strong> <a href="{{ data.source_repo|e }}" target="_blank">{{ data.source_repo|e }}</a></p>
    {% endif %}
    {% if data.scorecard_available and data.checks %}
        <div class="overflow-auto">
            <table class="striped">
                <thead>
                    <tr>
                        <th>Check</th>
                        <th>Score</th>
                        <th>Reason</th>
                    </tr>
                </thead>
                <tbody>
                    {% for c in data.checks|sort(attribute="score") %}
                    <tr>
                        <td><strong>{{ c.name|e }}</strong></td>
                        <td>
                            {% if c.score == -1 %}
                                <span style="opacity: 0.5;">N/A</span>
                            {% elif c.score >= 7 %}
                                {{ m.badge(c.score ~ "/10") }}
                            {% elif c.score >= 4 %}
                                {{ m.badge(c.score ~ "/10", status="warning") }}
                            {% else %}
                                {{ m.badge(c.score ~ "/10", status="error") }}
                            {% endif %}
                        </td>
                        <td><small>{{ c.reason|e }}</small></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% elif not data.scorecard_available %}
        <p>⚠️ OpenSSF Scorecard data unavailable for this image.</p>
    {% else %}
        <p>No checks found.</p>
    {% endif %}
</article>
