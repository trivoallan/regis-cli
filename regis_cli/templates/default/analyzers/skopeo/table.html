{% set data = report.results.get('skopeo', {}) %}
{% if data %}
<div class="overflow-auto">
    <table class="striped">
        <thead>
            <tr>
                <th>Platform</th>
                <th>Digest</th>
                <th>User</th>
                <th>Created</th>
                <th>Layers</th>
                <th>Labels</th>
            </tr>
        </thead>
        <tbody>
            {% for plat in data.platforms %}
            <tr>
                <td>
                    <strong>{{ plat.os }}/{{ plat.architecture }}</strong>
                    {% if plat.variant %}<small>({{ plat.variant }})</small>{% endif %}
                </td>
                <td>
                    {% if plat.digest %}
                        <code title="{{ plat.digest }}">{{ plat.digest[:12] }}...</code>
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if plat.user == '' or plat.user == '0' or plat.user == 'root' %}
                        <span class="badge danger">root</span>
                    {% else %}
                        <code>{{ plat.user }}</code>
                    {% endif %}
                </td>
                <td><small>{{ plat.created or '-' }}</small></td>
                <td>{{ plat.layers_count }}</td>
                <td>
                    {% if plat.labels %}
                        <span title="{{ plat.labels | length }} labels">{{ plat.labels | length }}</span>
                    {% else %}
                        0
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if data.tags %}
<div style="margin-top: 1rem;">
    <strong>Recent Tags:</strong>
    <code style="font-size: 0.85rem;">{{ data.tags[:10] | join(', ') }}{% if data.tags | length > 10 %}...{% endif %}</code>
</div>
{% endif %}

{% if data.inspect %}
<details style="margin-top: 1rem;">
    <summary>Raw Metadata (JSON)</summary>
    <pre style="font-size: 0.8rem; max-height: 300px; overflow: auto;"><code>{{ data.inspect | tojson(indent=2) }}</code></pre>
</details>
{% endif %}
{% endif %}
