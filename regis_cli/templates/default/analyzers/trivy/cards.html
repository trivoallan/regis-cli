{% set trivy_data = report.results.get('trivy', {}) %}
{% set options = w.options | default({}) %}
{% set severities = options.get('severities', ['CRITICAL', 'HIGH']) %}

{% if trivy_data %}
<div class="grid">
    {% for sev in severities %}
        {% set count_key = sev | lower ~ '_count' %}
        {% set count = trivy_data.get(count_key, 0) %}
        <div style="text-align: center; padding: var(--pico-spacing); background: var(--pico-card-background-color); border-radius: var(--pico-border-radius); box-shadow: var(--pico-card-box-shadow);">
            <strong style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">{{ sev }}</strong><br>
            <!-- prettier-ignore-start -->
            <span style="font-size: 2rem; font-weight: bold; line-height: 1; {% if count > 0 and sev in ['CRITICAL', 'HIGH'] %}color: var(--pico-del-color);{% endif %}">
                {{ count }}
            </span>
            <!-- prettier-ignore-end -->
        </div>
    {% endfor %}
</div>
{% else %}
<p><em>No Trivy results available.</em></p>
{% endif %}
